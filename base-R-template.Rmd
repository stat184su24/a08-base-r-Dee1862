---
title: "A08 Base R"
author: "Deekshith Reddy Bhoomireddy"
date: "30th July 2024"
output: 
    html_notebook
---

### Question 1: Subsetting

#### Select the element in 10th row and 5th column in `iris` dataset

```{r}
library(tidyverse)
library(dplyr)
data(iris)
iris[10, 5]

```


#### Select the Species column in `iris` dataset and print the last 5 rows of that column
```{r}
iris %>%
  select(Species) %>%
  tail(n = 5)
```


#### What is the average Sepal Length of flowers with Petal widths greater than 1? 

```{r}
iris %>%
  filter(Petal.Width > 1) %>%
  summarise(avg = mean(Sepal.Length))


```

### Question 2: For Loops

#### Write a `for` loop that iterates over the numbers 1 to 10. If the number less than 5 print the multiple of 3 (multiply the number by 3), and if the number is greater than or equal to 5 print the multiple of 2 (multiply the number by 2). 

```{r}
num <- 1:10
for (values in num) {
  if (values >= 5) {
    print(values * 2)
  }else {
    print(values * 3)
  }
}

```

### Question 3: While loops

#### Write a `while` loop that prints out random normal numbers with mean equal 1 and standard deviation 2 (use rnorm()) but stops (breaks) if you get a number bigger than 3. Do not change the value inside set.seeed.
```{r}
set.seed(184)

while (TRUE) {
  num <- rnorm(n = 1, mean = 1, sd = 2)
  print(num)
  if (num > 3) {
    break
  }
}

```

### Question 4: for loops in data tables

#### Use a nested for loop that produces the following data frame. Name the dataframe  `Counting` and the variables (columns)  V1, V2, V3, and V4.  (There are 3 loops). 

Hint: First identify the pattern(s) in the table before you create the for loop.

| V1 | V2 | V3 | V4 |  
|:-- |:-- |:-- |:-- |
| 1 | 2 | 3 | 4 |  
| 2 | 3 | 4 | 5 |  
| 3 | 4 | 5 | 6 |  

```{r}
V1 <- 1:3
V2 <- 1:3
V3 <- 1:3
V4 <- 1:3

for (r in 1:3) {
  for (c in 1:4) {
    if (c == 1) {
      V1[r] <- r + 0
      }
    if (c == 2) {
      V2[r] <- r + 1
    }
    if (c == 3) {
      V3[r] <- r + 2
    }
    if (c == 4) {
      V4[r] <- r + 3
    }
  }
}
data.frame(V1, V2, V3, V4)

```

### Question 5: user defined functions

#### 5A) Complete the following user define function to generate `n` random normal numbers with a given mean and standard deviation and plot a histogram of it. Do not change  the seed number in set.seed. You can use the function `hist` to plot the histogram.  

##### 5B) Then call the function to generate 1000 random normal numbers with mean 0 and standard deviation 1 and plot a histogram of it.

```{r}
set.seed(184)
plotNormal <- function(repitions, mean, sd){
  rnormal <- rnorm(repitions, mean, sd)
  hist(rnormal)
}

plotNormal(1000, 0, 1)

```

##### Extra Credit: 

Repeat parts 5A and 5B, and add 

1. A title that say "Histogram from a Normal(`mean`, `sd`) Distribution", but the user given values of `mean` and `sd`.
2. an argument to change the color of the histogram.  

Call the function to generate 1000 random normal numbers with mean 0 and standard deviation 1 and plot a histogram. Make the bins blue.

```{r}
set.seed(184)
plotNormal <- function(repitions, mean, sd, color){
  rnormal <- rnorm(repitions, mean, sd)
  hist(rnormal, main = paste("Histogram from a Normal(", mean, ", ", sd, ") Distribution"), col = color)
}

plotNormal(1000, 0, 1, "darkred")



```
